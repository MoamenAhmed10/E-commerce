<div class="orders-page">
  <div class="container">
    <div class="page-header">
      <h1>My Orders</h1>
      <a routerLink="/products" class="btn btn-primary">Continue Shopping</a>
    </div>

    @if (isLoading()) {
      <app-loading [center]="true" message="Loading orders..." />
    } @else if (orders().length === 0) {
      <div class="empty-state">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="64"
          height="64"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
          <path d="M3 6h18"></path>
          <path d="M16 10a4 4 0 0 1-8 0"></path>
        </svg>
        <h2>No orders yet</h2>
        <p>When you place an order, it will appear here.</p>
        <a routerLink="/products" class="btn btn-primary">Start Shopping</a>
      </div>
    } @else {
      <div class="orders-list">
        @for (order of orders(); track order._id) {
          <div class="order-card">
            <div class="order-header">
              <div class="order-info">
                <span class="order-number">Order #{{ order.orderNumber }}</span>
                <span class="order-date">{{ order.createdAt | date: 'mediumDate' }}</span>
              </div>
              <span class="order-status" [class]="order.status">{{
                order.status | titlecase
              }}</span>
            </div>
            <div class="order-items">
              @for (item of order.items.slice(0, 3); track item.productId) {
                <div class="order-item">
                  <img
                    [src]="item.productImage || '/assets/images/placeholder.jpg'"
                    [alt]="item.productName"
                  />
                  <div class="item-info">
                    <span class="item-name">{{ item.productName }}</span>
                    <span class="item-qty"
                      >Qty: {{ item.quantity }} Ã— {{ item.price | currency }}</span
                    >
                  </div>
                </div>
              }
              @if (order.items.length > 3) {
                <div class="more-items">+{{ order.items.length - 3 }} more items</div>
              }
            </div>
            <div class="order-footer">
              <span class="order-total">Total: {{ order.subtotal | currency }}</span>
              <a [routerLink]="['/account/orders', order._id]" class="btn btn-outline"
                >View Details</a
              >
            </div>
          </div>
        }
      </div>

      @if (pagination()) {
        <app-pagination
          [currentPage]="pagination()!.page"
          [totalPages]="pagination()!.totalPages"
          (pageChange)="onPageChange($event)"
        />
      }
    }
  </div>
</div>
